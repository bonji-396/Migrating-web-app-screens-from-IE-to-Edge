# 調査

## 目的
- 現行システムの稼働状況を把握し、IE依存部分を特定する
- Edgeでの動作確認を行い、問題点を洗い出す
- 修正範囲の見積もりと修正手法の確立を目指す

## ゴール
1. Edge対応で動作が可能になること（完全な動作保証は後続タスク）
2. 中期的な延命措置ができること
3. 必要に応じた部分的刷新の道筋をつける


## 1. システム全体の把握
### 1.1. システムの概要を把握
- 各システム（数システム）での役割
- どの機能がIE依存かを特定する
- システムごとの優先度（どのシステムを最初に対応するか）

### 1.2. システムの概要を把握

- ASP（Classic ASP）内のHTMLテンプレート部分
- VBコードとテンプレートHTMLの結合方法
- クライアントサイド（jQuery/Ajax）とサーバーサイド間の通信形式

## 2. クライアントサイド（ブラウザ動作）の確認

### 2.1. HTMLとCSS
- HTML4や非標準タグ（例: `<bgsound>`、`<marquee>`、`<font>`）が含まれているか
- IE固有のCSSプロパティ（例: -ms-）の利用状況
### 2.2. JavaScript
- jQueryや古いJavaScriptコードの互換性確認
- IE固有のAPI（例: `attachEvent`、`document.all`）の有無
- Edge非推奨のイベント（例: `keypress`）が使われていないか
### 2.3. Ajax通信
- `jQuery`の`$.ajax`を使用しているか
- Edgeでは`Authorization`ヘッダーの設定やCORS対応が必要になる場合がある
### 2.4. Edgeでの動作確認
- **DevTools（F12）**を活用してJavaScriptエラー、CSS崩れ、ネットワーク通信のエラーを調査

## 3. サーバーサイド（ASP）動作の確認

### 3.1. HTML生成ロジック
-  ASPスクリプト内で動的に生成されるHTML構造を特定する
-  Response.Writeや`<%= %>`で埋め込まれるHTMLを解析
### 3.2. 通信仕様
-  Ajax通信を受け付けるサーバーサイド処理の挙動確認
-  クエリパラメータやヘッダー情報の処理が古い形式になっていないか
### 3.3. 文字コード
-  サーバーが生成するレスポンスの文字エンコード（例: Shift-JIS, UTF-8）を確認
-  Edgeで文字化けが発生しないようにする
### 3.4. 外部システムとの連携
-  他システムとの連携部分でIE依存の仕様がないか

### 4. デバイスおよび出力の確認

### 4.1. 帳票出力:
- ActiveXや非標準技術で帳票を生成している部分の有無
- EdgeではJavaScriptベースの帳票生成（例: SheetJS）やサーバーサイドPDF生成への移行を検討
### 4.2. プリンタ連携:
- プリンタ制御がActiveXに依存している場合、修正が必要
### 4.3. ファイルアップロード/ダウンロード:
- IE固有のファイルアップロード/ダウンロード方法が使用されていないか


### 5. セキュリティと認証
### 5.1. 認証方式:
- NTLM認証など、IE特有の認証方式に依存していないか
- Edge対応として、CORSポリシーやJWTトークンの利用を検討
### 5.2. セキュリティポリシー:
- Edgeのセキュリティ強化（例: サードパーティクッキー制限、ポップアップ制御）で影響が出る箇所の特定